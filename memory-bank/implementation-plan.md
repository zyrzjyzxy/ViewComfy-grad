# ç®¡ç†å‘˜åŠŸèƒ½å®ç°è®¡åˆ’

## 1. é¡¹ç›®æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è§„åˆ’ iRetexturing ç³»ç»Ÿç®¡ç†å‘˜åŠŸèƒ½çš„å®ç°æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ç®¡ç†å‘˜è´¦æˆ·ç³»ç»Ÿã€ç”¨æˆ·ç®¡ç†ã€ç”Ÿæˆè®°å½•ç®¡ç†ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

## 2. ç°æœ‰ç³»ç»Ÿæ¶æ„åˆ†æ

### 2.1 æ•°æ®åº“æ¨¡å‹

å½“å‰ç³»ç»Ÿä½¿ç”¨ Prisma ORM + SQLite æ•°æ®åº“ï¼ŒåŒ…å«ä»¥ä¸‹æ¨¡å‹ï¼š

```prisma
model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  password  String   // å­˜å‚¨ bcrypt åŠ å¯†åçš„å¯†ç 
  name      String?  // å¯é€‰
  createdAt DateTime @default(now())
  histories History[]
}

model History {
  id              Int      @id @default(autoincrement())
  userId          Int
  user            User     @relation(fields: [userId], references: [id])
  textureName     String?
  textureImage    String?
  fashionName     String?
  fashionImage    String?
  fashionType     String?
  prompt          String
  imagePath       String
  seed            Int?
  createdAt       DateTime @default(now())
}
```

### 2.2 è®¤è¯ç³»ç»Ÿ

- ä½¿ç”¨ JWT token è¿›è¡Œèº«ä»½éªŒè¯
- AuthContext æä¾›å…¨å±€è®¤è¯çŠ¶æ€ç®¡ç†
- API è·¯ç”±ï¼š`/api/auth/login`, `/api/auth/register`
- å¯†ç ä½¿ç”¨ bcrypt åŠ å¯†ï¼ˆsalt rounds: 10ï¼‰
- JWT token æœ‰æ•ˆæœŸï¼š7 å¤©

### 2.3 ç°æœ‰ API

- `/api/history` - è·å–å½“å‰ç”¨æˆ·å†å²è®°å½•
- `/api/history/export` - å¯¼å‡ºå†å²è®°å½•
- `/api/comfy` - ComfyUI å›¾åƒç”Ÿæˆ API

## 3. åŠŸèƒ½éœ€æ±‚åˆ†æ

æ ¹æ®è®¾è®¡æ–‡æ¡£ï¼Œç®¡ç†å‘˜åŠŸèƒ½éœ€è¦å®ç°ä»¥ä¸‹ä¸‰ä¸ªæ ¸å¿ƒåŠŸèƒ½ï¼š

### 3.1 ç”¨æˆ·ç®¡ç†åŠŸèƒ½
- **åˆ›å»ºç”¨æˆ·**ï¼šç®¡ç†å‘˜å¯ä»¥åˆ›å»ºæ–°çš„ç”¨æˆ·è´¦æˆ·
- **åˆ é™¤ç”¨æˆ·**ï¼šç®¡ç†å‘˜å¯ä»¥åˆ é™¤æŒ‡å®šç”¨æˆ·è´¦æˆ·
- **æ›´æ–°ç”¨æˆ·ä¿¡æ¯**ï¼šç®¡ç†å‘˜å¯ä»¥æ›´æ–°ç”¨æˆ·çš„ç™»å½•ä¿¡æ¯ï¼ˆé‚®ç®±ã€å§“åç­‰ï¼‰
- **é‡ç½®ç”¨æˆ·å¯†ç **ï¼šç®¡ç†å‘˜å¯ä»¥ä¸ºç”¨æˆ·é‡ç½®å¯†ç 
- **æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯**ï¼šç®¡ç†å‘˜å¯ä»¥æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·çš„ç™»å½•ä¿¡æ¯å’Œç»Ÿè®¡ä¿¡æ¯

### 3.2 ç”Ÿæˆè®°å½•ç®¡ç†åŠŸèƒ½
- **æŸ¥çœ‹æ‰€æœ‰è®°å½•**ï¼šç®¡ç†å‘˜å¯ä»¥æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·çš„ç”Ÿæˆè®°å½•
- **åˆ é™¤æŒ‡å®šè®°å½•**ï¼šç®¡ç†å‘˜å¯ä»¥åˆ é™¤æŒ‡å®šçš„ç”Ÿæˆè®°å½•
- **æ‰¹é‡åˆ é™¤è®°å½•**ï¼šç®¡ç†å‘˜å¯ä»¥æ‰¹é‡åˆ é™¤å¤šæ¡ç”Ÿæˆè®°å½•
- **è®°å½•ç­›é€‰**ï¼šç®¡ç†å‘˜å¯ä»¥æŒ‰ç”¨æˆ·ã€æ—¥æœŸç­‰æ¡ä»¶ç­›é€‰è®°å½•

### 3.3 ç»Ÿè®¡æ•°æ®åŠŸèƒ½
- **ç”¨æˆ·æ•°é‡ç»Ÿè®¡**ï¼šæŸ¥çœ‹ç³»ç»Ÿçš„ç”¨æˆ·æ€»æ•°ã€ç®¡ç†å‘˜æ•°é‡
- **ç”Ÿæˆè®°å½•ç»Ÿè®¡**ï¼šæŸ¥çœ‹ç³»ç»Ÿçš„ç”Ÿæˆè®°å½•æ€»æ•°ã€ä»Šæ—¥ç”Ÿæˆè®°å½•æ•°
- **å…¶ä»–ç»Ÿè®¡ä¿¡æ¯**ï¼šä»Šæ—¥æ–°å¢ç”¨æˆ·æ•°ã€å­˜å‚¨ä½¿ç”¨æƒ…å†µç­‰

### 3.4 ç•Œé¢å’Œå¯¼èˆªè¦æ±‚
- **ç‹¬ç«‹çš„ç®¡ç†å‘˜å·¥ä½œå°**ï¼šç®¡ç†å‘˜å·¥ä½œå°ä¸ç”¨æˆ·å·¥ä½œå°åº”è¯¥æœ‰æ˜ç¡®çš„ç•Œé¢åŒºåˆ†ï¼Œä¸èƒ½æ˜¾ç¤ºåœ¨åŒä¸€ä¸ªé¡µé¢
- **ä¾§è¾¹æ å¯¼èˆªå…¥å£**ï¼šç®¡ç†å‘˜ç™»å½•åï¼Œä¾§è¾¹æ åº”æ˜¾ç¤ºç®¡ç†åŠŸèƒ½çš„å…¥å£ï¼Œç‚¹å‡»åå¯è·³è½¬åˆ°ç›¸åº”çš„ç®¡ç†é¡µé¢
- **ä¸‰ä¸ªåŠŸèƒ½å¯¹åº”ä¸‰ä¸ªé¡µé¢**ï¼šç”¨æˆ·ç®¡ç†ã€ç”Ÿæˆè®°å½•ç®¡ç†ã€ç»Ÿè®¡æ•°æ®åº”åˆ†åˆ«å¯¹åº”ç‹¬ç«‹çš„ç®¡ç†é¡µé¢

### 3.5 API æ¥å£æ˜ å°„
ä¸Šè¿°ä¸‰ä¸ªåŠŸèƒ½åº”è¯¥åˆ†åˆ«å¯¹åº”åç«¯çš„ API æ¥å£ï¼š
- **ç”¨æˆ·ç®¡ç† API**ï¼š`/api/admin/users/*`
- **ç”Ÿæˆè®°å½•ç®¡ç† API**ï¼š`/api/admin/histories/*`
- **ç»Ÿè®¡æ•°æ® API**ï¼š`/api/admin/stats`

## 4. å®ç°æ–¹æ¡ˆè®¾è®¡

### 4.1 æ•°æ®åº“æ¨¡å‹æ‰©å±•

#### 4.1.1 ä¿®æ”¹ User æ¨¡å‹

```prisma
model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  password  String   // å­˜å‚¨ bcrypt åŠ å¯†åçš„å¯†ç 
  name      String?  // å¯é€‰
  role      Role     @default(USER) // æ–°å¢ï¼šç”¨æˆ·è§’è‰²
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt // æ–°å¢ï¼šæ›´æ–°æ—¶é—´
  histories History[]
}

enum Role {
  USER     // æ™®é€šç”¨æˆ·
  ADMIN    // ç®¡ç†å‘˜
}
```

#### 4.1.2 æ•°æ®åº“è¿ç§»

åˆ›å»ºæ–°çš„è¿ç§»æ–‡ä»¶ï¼Œæ·»åŠ  `role` å’Œ `updatedAt` å­—æ®µã€‚

### 4.2 è®¤è¯ç³»ç»Ÿæ‰©å±•

#### 4.2.1 ä¿®æ”¹ AuthContext

```typescript
interface User {
  id: number;
  email: string;
  name?: string;
  role: 'USER' | 'ADMIN'; // æ–°å¢è§’è‰²å­—æ®µ
}

interface AuthContextType {
  user: User | null;
  isAdmin: boolean; // æ–°å¢ï¼šæ˜¯å¦ä¸ºç®¡ç†å‘˜
  login: (email: string, password: string) => Promise<void>;
  register: (email: string, password: string, name?: string) => Promise<void>;
  logout: () => void;
  isLoading: boolean;
}
```

#### 4.2.2 ä¿®æ”¹ç™»å½• API

æ›´æ–° `/api/auth/login/route.ts`ï¼Œåœ¨è¿”å›çš„ç”¨æˆ·ä¿¡æ¯ä¸­åŒ…å«è§’è‰²å­—æ®µã€‚

#### 4.2.3 åˆ›å»ºç®¡ç†å‘˜ç™»å½•éªŒè¯ä¸­é—´ä»¶

åˆ›å»º `lib/admin-auth.ts`ï¼Œæä¾›ç®¡ç†å‘˜æƒé™éªŒè¯å‡½æ•°ï¼š

```typescript
export function verifyAdminToken(token: string): { userId: number; email: string } {
  const decoded = verify(token, JWT_SECRET) as JwtPayload;
  const user = await prisma.user.findUnique({
    where: { id: decoded.userId }
  });
  
  if (!user || user.role !== 'ADMIN') {
    throw new Error('æ— ç®¡ç†å‘˜æƒé™');
  }
  
  return decoded;
}
```

### 4.3 API è·¯ç”±è®¾è®¡

#### 4.3.1 ç”¨æˆ·ç®¡ç† API

**GET `/api/admin/users`**
- åŠŸèƒ½ï¼šè·å–æ‰€æœ‰ç”¨æˆ·åˆ—è¡¨
- æƒé™ï¼šä»…ç®¡ç†å‘˜
- å‚æ•°ï¼š
  - `page`: é¡µç ï¼ˆé»˜è®¤ 1ï¼‰
  - `limit`: æ¯é¡µæ•°é‡ï¼ˆé»˜è®¤ 20ï¼‰
  - `search`: æœç´¢å…³é”®è¯ï¼ˆé‚®ç®±æˆ–å§“åï¼‰
- è¿”å›ï¼šç”¨æˆ·åˆ—è¡¨åŠåˆ†é¡µä¿¡æ¯

**GET `/api/admin/users/[id]`**
- åŠŸèƒ½ï¼šè·å–æŒ‡å®šç”¨æˆ·è¯¦æƒ…
- æƒé™ï¼šä»…ç®¡ç†å‘˜
- è¿”å›ï¼šç”¨æˆ·è¯¦ç»†ä¿¡æ¯åŠå†å²è®°å½•ç»Ÿè®¡

**POST `/api/admin/users`**
- åŠŸèƒ½ï¼šåˆ›å»ºæ–°ç”¨æˆ·
- æƒé™ï¼šä»…ç®¡ç†å‘˜
- è¯·æ±‚ä½“ï¼š`{ email, password, name, role }`
- è¿”å›ï¼šåˆ›å»ºçš„ç”¨æˆ·ä¿¡æ¯

**PUT `/api/admin/users/[id]`**
- åŠŸèƒ½ï¼šæ›´æ–°ç”¨æˆ·ä¿¡æ¯
- æƒé™ï¼šä»…ç®¡ç†å‘˜
- è¯·æ±‚ä½“ï¼š`{ email?, password?, name?, role? }`
- è¿”å›ï¼šæ›´æ–°åçš„ç”¨æˆ·ä¿¡æ¯

**DELETE `/api/admin/users/[id]`**
- åŠŸèƒ½ï¼šåˆ é™¤ç”¨æˆ·
- æƒé™ï¼šä»…ç®¡ç†å‘˜
- çº§è”åˆ é™¤ï¼šåŒæ—¶åˆ é™¤ç”¨æˆ·çš„æ‰€æœ‰å†å²è®°å½•
- è¿”å›ï¼šåˆ é™¤ç¡®è®¤ä¿¡æ¯

**POST `/api/admin/users/[id]/reset-password`**
- åŠŸèƒ½ï¼šé‡ç½®ç”¨æˆ·å¯†ç 
- æƒé™ï¼šä»…ç®¡ç†å‘˜
- è¯·æ±‚ä½“ï¼š`{ newPassword }`
- è¿”å›ï¼šæ“ä½œç»“æœ

#### 4.3.2 ç”Ÿæˆè®°å½•ç®¡ç† API

**GET `/api/admin/histories`**
- åŠŸèƒ½ï¼šè·å–æ‰€æœ‰ç”¨æˆ·çš„ç”Ÿæˆè®°å½•
- æƒé™ï¼šä»…ç®¡ç†å‘˜
- å‚æ•°ï¼š
  - `page`: é¡µç 
  - `limit`: æ¯é¡µæ•°é‡
  - `userId`: ç­›é€‰ç‰¹å®šç”¨æˆ·
  - `startDate`: å¼€å§‹æ—¥æœŸ
  - `endDate`: ç»“æŸæ—¥æœŸ
- è¿”å›ï¼šå†å²è®°å½•åˆ—è¡¨åŠåˆ†é¡µä¿¡æ¯

**DELETE `/api/admin/histories/[id]`**
- åŠŸèƒ½ï¼šåˆ é™¤æŒ‡å®šå†å²è®°å½•
- æƒé™ï¼šä»…ç®¡ç†å‘˜
- è¿”å›ï¼šåˆ é™¤ç¡®è®¤ä¿¡æ¯

**DELETE `/api/admin/histories/batch`**
- åŠŸèƒ½ï¼šæ‰¹é‡åˆ é™¤å†å²è®°å½•
- æƒé™ï¼šä»…ç®¡ç†å‘˜
- è¯·æ±‚ä½“ï¼š`{ ids: number[] }`
- è¿”å›ï¼šåˆ é™¤ç»“æœç»Ÿè®¡

**DELETE `/api/admin/histories/user/[userId]`**
- åŠŸèƒ½ï¼šåˆ é™¤æŒ‡å®šç”¨æˆ·çš„æ‰€æœ‰å†å²è®°å½•
- æƒé™ï¼šä»…ç®¡ç†å‘˜
- è¿”å›ï¼šåˆ é™¤ç»“æœç»Ÿè®¡

#### 4.3.3 ç»Ÿè®¡æ•°æ® API

**GET `/api/admin/stats`**
- åŠŸèƒ½ï¼šè·å–ç³»ç»Ÿç»Ÿè®¡æ•°æ®
- æƒé™ï¼šä»…ç®¡ç†å‘˜
- è¿”å›ï¼š
  - ç”¨æˆ·æ€»æ•°
  - ç®¡ç†å‘˜æ•°é‡
  - å†å²è®°å½•æ€»æ•°
  - ä»Šæ—¥æ–°å¢ç”¨æˆ·æ•°
  - ä»Šæ—¥ç”Ÿæˆè®°å½•æ•°
  - å­˜å‚¨ç©ºé—´ä½¿ç”¨æƒ…å†µ

### 4.4 å‰ç«¯ç•Œé¢è®¾è®¡

#### 4.4.1 ç•Œé¢æ¶æ„è®¾è®¡

æ ¹æ®è®¾è®¡æ–‡æ¡£è¦æ±‚ï¼Œç®¡ç†å‘˜å·¥ä½œå°ä¸ç”¨æˆ·å·¥ä½œå°åº”è¯¥æœ‰æ˜ç¡®çš„ç•Œé¢åŒºåˆ†ï¼š

**ç•Œé¢æ¶æ„åŸåˆ™ï¼š**
1. **ç‹¬ç«‹çš„é¡µé¢ç»“æ„**ï¼šç®¡ç†å‘˜åŠŸèƒ½ä½¿ç”¨ç‹¬ç«‹çš„é¡µé¢è·¯å¾„ `/admin/*`ï¼Œä¸ç”¨æˆ·åŠŸèƒ½å®Œå…¨åˆ†ç¦»
2. **ä¸åŒçš„å¸ƒå±€é£æ ¼**ï¼šç®¡ç†å‘˜ç•Œé¢é‡‡ç”¨æ›´ä¸“ä¸šçš„ç®¡ç†åå°é£æ ¼ï¼Œä¸ç”¨æˆ·ç•Œé¢æœ‰æ˜æ˜¾è§†è§‰åŒºåˆ†
3. **ç‹¬ç«‹çš„å¯¼èˆªç³»ç»Ÿ**ï¼šç®¡ç†å‘˜æ‹¥æœ‰ç‹¬ç«‹çš„ç®¡ç†å¯¼èˆªèœå•ï¼Œä¸ä¸ç”¨æˆ·åŠŸèƒ½æ··åœ¨ä¸€èµ·
4. **æƒé™éš”ç¦»**ï¼šç®¡ç†å‘˜é¡µé¢åªèƒ½ç”±ç®¡ç†å‘˜è®¿é—®ï¼Œæ™®é€šç”¨æˆ·æ— æ³•è®¿é—®

**é¡µé¢ç»“æ„ï¼š**
```
/
â”œâ”€â”€ /                          # ç”¨æˆ·é¦–é¡µ
â”œâ”€â”€ /playground                # ç”¨æˆ·å·¥ä½œå°
â”œâ”€â”€ /history                   # ç”¨æˆ·å†å²è®°å½•
â”œâ”€â”€ /profile                   # ç”¨æˆ·ä¸ªäººä¸­å¿ƒ
â””â”€â”€ /admin/                   # ç®¡ç†å‘˜å·¥ä½œå°ï¼ˆç‹¬ç«‹ï¼‰
    â”œâ”€â”€ /                      # ç®¡ç†å‘˜ä»ªè¡¨æ¿ï¼ˆç»Ÿè®¡æ•°æ®ï¼‰
    â”œâ”€â”€ /users/                # ç”¨æˆ·ç®¡ç†é¡µé¢
    â”‚   â””â”€â”€ /[id]/           # ç”¨æˆ·è¯¦æƒ…é¡µé¢
    â””â”€â”€ /histories/           # ç”Ÿæˆè®°å½•ç®¡ç†é¡µé¢
```

#### 4.4.2 ç™»å½•ç•Œé¢æ”¹é€ 

åœ¨ç°æœ‰ç™»å½•ç•Œé¢æ·»åŠ ç®¡ç†å‘˜ç™»å½•é€‰é¡¹ï¼š

```tsx
<div className="flex space-x-4 mb-4">
  <button
    className={`flex-1 py-2 px-4 rounded-lg ${!isAdminMode ? 'bg-blue-600 text-white' : 'bg-gray-200'}`}
    onClick={() => setIsAdminMode(false)}
  >
    ç”¨æˆ·ç™»å½•
  </button>
  <button
    className={`flex-1 py-2 px-4 rounded-lg ${isAdminMode ? 'bg-blue-600 text-white' : 'bg-gray-200'}`}
    onClick={() => setIsAdminMode(true)}
  >
    ç®¡ç†å‘˜ç™»å½•
  </button>
</div>
```

#### 4.4.3 ç®¡ç†å‘˜ä»ªè¡¨æ¿é¡µé¢ï¼ˆç»Ÿè®¡æ•°æ®ï¼‰

åˆ›å»º `/app/admin/page.tsx`ï¼Œè¿™æ˜¯ç®¡ç†å‘˜å·¥ä½œå°çš„ä¸»é¡µé¢ï¼Œä¸“é—¨ç”¨äºæ˜¾ç¤ºç³»ç»Ÿç»Ÿè®¡æ•°æ®ï¼š

**é¡µé¢å¸ƒå±€ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç®¡ç†å‘˜å·¥ä½œå° - ç³»ç»Ÿç»Ÿè®¡                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ ç”¨æˆ·æ€»æ•°  â”‚  â”‚ è®°å½•æ€»æ•°  â”‚  â”‚ ä»Šæ—¥æ–°å¢  â”‚         â”‚
â”‚  â”‚   128    â”‚  â”‚  1,234   â”‚  â”‚   5      â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚  â”‚ ä»Šæ—¥è®°å½•  â”‚  â”‚ å­˜å‚¨ä½¿ç”¨  â”‚                        â”‚
â”‚  â”‚   23     â”‚  â”‚  2.5 GB  â”‚                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å¿«é€Ÿæ“ä½œ                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚  æ·»åŠ æ–°ç”¨æˆ·   â”‚  â”‚  æŸ¥çœ‹æœ€è¿‘è®°å½• â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å¯¼èˆªèœå•                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  ğŸ‘¥ ç”¨æˆ·ç®¡ç† (è·³è½¬åˆ° /admin/users)           â”‚ â”‚
â”‚  â”‚  ğŸ“„ ç”Ÿæˆè®°å½•ç®¡ç† (è·³è½¬åˆ° /admin/histories)   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åŠŸèƒ½è¯´æ˜ï¼š**
1. **ç»Ÿè®¡å¡ç‰‡åŒºåŸŸ**ï¼šæ˜¾ç¤ºç³»ç»Ÿå…³é”®ç»Ÿè®¡æ•°æ®
   - ç”¨æˆ·æ€»æ•°ï¼šç³»ç»Ÿä¸­çš„æ‰€æœ‰ç”¨æˆ·æ•°é‡
   - å†å²è®°å½•æ€»æ•°ï¼šç³»ç»Ÿä¸­çš„æ‰€æœ‰ç”Ÿæˆè®°å½•æ•°é‡
   - ä»Šæ—¥æ–°å¢ç”¨æˆ·ï¼šä»Šå¤©æ–°æ³¨å†Œçš„ç”¨æˆ·æ•°é‡
   - ä»Šæ—¥ç”Ÿæˆè®°å½•ï¼šä»Šå¤©ç”Ÿæˆçš„è®°å½•æ•°é‡
   - å­˜å‚¨ä½¿ç”¨æƒ…å†µï¼šç³»ç»Ÿå­˜å‚¨ç©ºé—´ä½¿ç”¨æƒ…å†µ

2. **å¿«é€Ÿæ“ä½œåŒºåŸŸ**ï¼šæä¾›å¸¸ç”¨æ“ä½œçš„å¿«æ·å…¥å£
   - æ·»åŠ æ–°ç”¨æˆ·ï¼šè·³è½¬åˆ°ç”¨æˆ·ç®¡ç†é¡µé¢çš„åˆ›å»ºç”¨æˆ·å¯¹è¯æ¡†
   - æŸ¥çœ‹æœ€è¿‘è®°å½•ï¼šè·³è½¬åˆ°ç”Ÿæˆè®°å½•ç®¡ç†é¡µé¢å¹¶ç­›é€‰æœ€è¿‘è®°å½•

3. **å¯¼èˆªèœå•åŒºåŸŸ**ï¼šæä¾›ç®¡ç†åŠŸèƒ½çš„ä¸»è¦å¯¼èˆªå…¥å£
   - ç”¨æˆ·ç®¡ç†ï¼šè·³è½¬åˆ° `/admin/users` é¡µé¢
   - ç”Ÿæˆè®°å½•ç®¡ç†ï¼šè·³è½¬åˆ° `/admin/histories` é¡µé¢

#### 4.4.4 ç”¨æˆ·ç®¡ç†é¡µé¢

åˆ›å»º `/app/admin/users/page.tsx`ï¼Œè¿™æ˜¯ç”¨æˆ·ç®¡ç†çš„ä¸»è¦é¡µé¢ï¼š

**é¡µé¢å¸ƒå±€ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç®¡ç†å‘˜å·¥ä½œå° > ç”¨æˆ·ç®¡ç†                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æœç´¢å’Œç­›é€‰                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ” æœç´¢ç”¨æˆ·...  [è§’è‰²ç­›é€‰â–¼]  [æ—¥æœŸç­›é€‰â–¼]    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  [+ æ·»åŠ æ–°ç”¨æˆ·]                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç”¨æˆ·åˆ—è¡¨                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ID  â”‚ é‚®ç®±          â”‚ å§“å   â”‚ è§’è‰²  â”‚ æ“ä½œ  â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ 1   â”‚ user1@test.com â”‚ å¼ ä¸‰   â”‚ USER  â”‚ ç¼–è¾‘  â”‚   â”‚
â”‚  â”‚    â”‚               â”‚        â”‚       â”‚ åˆ é™¤  â”‚   â”‚
â”‚  â”‚    â”‚               â”‚        â”‚       â”‚ é‡ç½®  â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ 2   â”‚ user2@test.com â”‚ æå››   â”‚ ADMIN â”‚ ç¼–è¾‘  â”‚   â”‚
â”‚  â”‚    â”‚               â”‚        â”‚       â”‚ åˆ é™¤  â”‚   â”‚
â”‚  â”‚    â”‚               â”‚        â”‚       â”‚ é‡ç½®  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  [ä¸Šä¸€é¡µ]  ç¬¬ 1 é¡µ / å…± 5 é¡µ  [ä¸‹ä¸€é¡µ]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åŠŸèƒ½è¯´æ˜ï¼š**
1. **æœç´¢å’Œç­›é€‰åŒºåŸŸ**
   - æœç´¢æ¡†ï¼šæ”¯æŒæŒ‰é‚®ç®±æˆ–å§“åæœç´¢ç”¨æˆ·
   - è§’è‰²ç­›é€‰ï¼šæŒ‰ç”¨æˆ·è§’è‰²ç­›é€‰ï¼ˆå…¨éƒ¨/ç”¨æˆ·/ç®¡ç†å‘˜ï¼‰
   - æ—¥æœŸç­›é€‰ï¼šæŒ‰åˆ›å»ºæ—¥æœŸèŒƒå›´ç­›é€‰ç”¨æˆ·
   - æ·»åŠ æ–°ç”¨æˆ·æŒ‰é’®ï¼šæ‰“å¼€åˆ›å»ºç”¨æˆ·å¯¹è¯æ¡†

2. **ç”¨æˆ·åˆ—è¡¨è¡¨æ ¼**
   - IDï¼šç”¨æˆ·å”¯ä¸€æ ‡è¯†
   - é‚®ç®±ï¼šç”¨æˆ·ç™»å½•é‚®ç®±
   - å§“åï¼šç”¨æˆ·æ˜¾ç¤ºåç§°
   - è§’è‰²ï¼šç”¨æˆ·è§’è‰²ï¼ˆUSER/ADMINï¼‰
   - æ“ä½œæŒ‰é’®ï¼š
     - ç¼–è¾‘ï¼šæ‰“å¼€ç¼–è¾‘ç”¨æˆ·å¯¹è¯æ¡†
     - åˆ é™¤ï¼šåˆ é™¤ç”¨æˆ·ï¼ˆéœ€è¦ç¡®è®¤ï¼‰
     - é‡ç½®å¯†ç ï¼šé‡ç½®ç”¨æˆ·å¯†ç ï¼ˆéœ€è¦ç¡®è®¤ï¼‰

3. **åˆ†é¡µæ§åˆ¶**
   - æ”¯æŒåˆ†é¡µæµè§ˆç”¨æˆ·åˆ—è¡¨
   - æ˜¾ç¤ºå½“å‰é¡µç å’Œæ€»é¡µæ•°

4. **ç”¨æˆ·è¯¦æƒ…å¼¹çª—**
   - æ˜¾ç¤ºç”¨æˆ·åŸºæœ¬ä¿¡æ¯ï¼ˆIDã€é‚®ç®±ã€å§“åã€è§’è‰²ã€åˆ›å»ºæ—¶é—´ï¼‰
   - æ˜¾ç¤ºå†å²è®°å½•ç»Ÿè®¡ï¼ˆæ€»è®°å½•æ•°ã€æœ€è¿‘è®°å½•ï¼‰
   - æ˜¾ç¤ºæœ€è¿‘æ´»åŠ¨æ—¶é—´
   - æä¾›æ“ä½œæŒ‰é’®ï¼ˆç¼–è¾‘ã€é‡ç½®å¯†ç ã€åˆ é™¤ï¼‰

5. **ç¼–è¾‘ç”¨æˆ·å¼¹çª—**
   - æ”¯æŒä¿®æ”¹é‚®ç®±ã€å§“åã€è§’è‰²
   - æ”¯æŒä¿®æ”¹å¯†ç 
   - è¡¨å•éªŒè¯

6. **åˆ›å»ºç”¨æˆ·å¼¹çª—**
   - è¾“å…¥é‚®ç®±ã€å¯†ç ã€å§“åã€è§’è‰²
   - è¡¨å•éªŒè¯
   - å¯†ç å¼ºåº¦æç¤º

7. **é‡ç½®å¯†ç å¼¹çª—**
   - è¾“å…¥æ–°å¯†ç 
   - ç¡®è®¤æ–°å¯†ç 
   - å¯†ç å¼ºåº¦éªŒè¯

8. **åˆ é™¤ç¡®è®¤å¯¹è¯æ¡†**
   - æ˜¾ç¤ºè­¦å‘Šä¿¡æ¯
   - è¯´æ˜å°†åŒæ—¶åˆ é™¤ç”¨æˆ·çš„æ‰€æœ‰å†å²è®°å½•
   - éœ€è¦äºŒæ¬¡ç¡®è®¤

#### 4.4.5 ç”Ÿæˆè®°å½•ç®¡ç†é¡µé¢

åˆ›å»º `/app/admin/histories/page.tsx`ï¼Œè¿™æ˜¯ç”Ÿæˆè®°å½•ç®¡ç†çš„ä¸»è¦é¡µé¢ï¼š

**é¡µé¢å¸ƒå±€ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç®¡ç†å‘˜å·¥ä½œå° > ç”Ÿæˆè®°å½•ç®¡ç†                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç­›é€‰å’Œæ‰¹é‡æ“ä½œ                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ [ç”¨æˆ·ç­›é€‰â–¼]  [æ—¥æœŸèŒƒå›´â–¼]  [ç±»å‹ç­›é€‰â–¼]       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  [æ‰¹é‡åˆ é™¤] [æ‰¹é‡å¯¼å‡º]                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è®°å½•åˆ—è¡¨                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â–¡ â”‚ ID  â”‚ ç”¨æˆ·é‚®ç®±      â”‚ ç±»å‹   â”‚ æ—¶é—´  â”‚ æ“ä½œâ”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ â–¡ â”‚ 1   â”‚ user1@test.comâ”‚ ä¸Šè¡£   â”‚ 10:30 â”‚ æŸ¥çœ‹â”‚   â”‚
â”‚  â”‚   â”‚     â”‚              â”‚        â”‚       â”‚ åˆ é™¤â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ â˜‘ â”‚ 2   â”‚ user2@test.comâ”‚ è£¤å­   â”‚ 11:15 â”‚ æŸ¥çœ‹â”‚   â”‚
â”‚  â”‚   â”‚     â”‚              â”‚        â”‚       â”‚ åˆ é™¤â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ â˜‘ â”‚ 3   â”‚ user3@test.comâ”‚ è£™å­   â”‚ 12:00 â”‚ æŸ¥çœ‹â”‚   â”‚
â”‚  â”‚   â”‚     â”‚              â”‚        â”‚       â”‚ åˆ é™¤â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  [ä¸Šä¸€é¡µ]  ç¬¬ 1 é¡µ / å…± 10 é¡µ  [ä¸‹ä¸€é¡µ]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åŠŸèƒ½è¯´æ˜ï¼š**
1. **ç­›é€‰åŒºåŸŸ**
   - ç”¨æˆ·ç­›é€‰ï¼šæŒ‰ç”¨æˆ·ç­›é€‰è®°å½•ï¼ˆæ˜¾ç¤ºç”¨æˆ·ä¸‹æ‹‰åˆ—è¡¨ï¼‰
   - æ—¥æœŸèŒƒå›´ç­›é€‰ï¼šæŒ‰ç”Ÿæˆæ—¥æœŸèŒƒå›´ç­›é€‰è®°å½•
   - ç±»å‹ç­›é€‰ï¼šæŒ‰æœè£…ç±»å‹ç­›é€‰è®°å½•ï¼ˆä¸Šè¡£/è£¤å­/è£™å­ç­‰ï¼‰

2. **æ‰¹é‡æ“ä½œåŒºåŸŸ**
   - æ‰¹é‡åˆ é™¤ï¼šåˆ é™¤é€‰ä¸­çš„è®°å½•ï¼ˆéœ€è¦ç¡®è®¤ï¼‰
   - æ‰¹é‡å¯¼å‡ºï¼šå¯¼å‡ºé€‰ä¸­çš„è®°å½•ä¿¡æ¯

3. **è®°å½•åˆ—è¡¨è¡¨æ ¼**
   - å¤é€‰æ¡†ï¼šæ”¯æŒæ‰¹é‡é€‰æ‹©è®°å½•
   - IDï¼šè®°å½•å”¯ä¸€æ ‡è¯†
   - ç”¨æˆ·é‚®ç®±ï¼šç”Ÿæˆè¯¥è®°å½•çš„ç”¨æˆ·
   - çº¹ç†åç§°ï¼šä½¿ç”¨çš„çº¹ç†åç§°
   - æœè£…åç§°ï¼šæœè£…åç§°
   - æœè£…ç±»å‹ï¼šæœè£…ç±»å‹ï¼ˆä¸Šè¡£/è£¤å­/è£™å­ç­‰ï¼‰
   - ç”Ÿæˆæ—¶é—´ï¼šè®°å½•åˆ›å»ºæ—¶é—´
   - æ“ä½œæŒ‰é’®ï¼š
     - æŸ¥çœ‹ï¼šæŸ¥çœ‹è®°å½•è¯¦æƒ…å’Œå›¾ç‰‡é¢„è§ˆ
     - åˆ é™¤ï¼šåˆ é™¤è¯¥è®°å½•ï¼ˆéœ€è¦ç¡®è®¤ï¼‰

4. **åˆ†é¡µæ§åˆ¶**
   - æ”¯æŒåˆ†é¡µæµè§ˆè®°å½•åˆ—è¡¨
   - æ˜¾ç¤ºå½“å‰é¡µç å’Œæ€»é¡µæ•°

5. **è®°å½•è¯¦æƒ…å¼¹çª—**
   - æ˜¾ç¤ºè®°å½•å®Œæ•´ä¿¡æ¯ï¼ˆIDã€ç”¨æˆ·ã€çº¹ç†ã€æœè£…ã€promptã€ç”Ÿæˆæ—¶é—´ç­‰ï¼‰
   - æ˜¾ç¤ºè¾“å…¥å›¾ç‰‡å’Œè¾“å‡ºå›¾ç‰‡
   - æ˜¾ç¤ºå›¾ç‰‡å¯¹æ¯”åŠŸèƒ½
   - æä¾›åˆ é™¤æŒ‰é’®

6. **å›¾ç‰‡é¢„è§ˆç»„ä»¶**
   - æ”¯æŒæŸ¥çœ‹åŸå§‹å›¾ç‰‡
   - æ”¯æŒæŸ¥çœ‹ç”Ÿæˆå›¾ç‰‡
   - æ”¯æŒå›¾ç‰‡å¯¹æ¯”
   - æ”¯æŒå›¾ç‰‡æ”¾å¤§ç¼©å°

7. **æ‰¹é‡åˆ é™¤ç¡®è®¤å¯¹è¯æ¡†**
   - æ˜¾ç¤ºé€‰ä¸­è®°å½•æ•°é‡
   - æ˜¾ç¤ºè­¦å‘Šä¿¡æ¯
   - éœ€è¦äºŒæ¬¡ç¡®è®¤

8. **æ‰¹é‡å¯¼å‡ºåŠŸèƒ½**
   - æ”¯æŒå¯¼å‡ºé€‰ä¸­è®°å½•çš„è¯¦ç»†ä¿¡æ¯
   - æ”¯æŒå¯¼å‡ºä¸º CSV æˆ– Excel æ ¼å¼
   - æ”¯æŒå¯¼å‡ºå›¾ç‰‡

#### 4.4.6 ç”¨æˆ·è¯¦æƒ…é¡µé¢

åˆ›å»º `/app/admin/users/[id]/page.tsx`ï¼ŒåŒ…å«ï¼š

1. **ç”¨æˆ·åŸºæœ¬ä¿¡æ¯**
2. **å†å²è®°å½•åˆ—è¡¨**
3. **æ“ä½œæŒ‰é’®**
   - ç¼–è¾‘ç”¨æˆ·ä¿¡æ¯
   - é‡ç½®å¯†ç 
   - åˆ é™¤ç”¨æˆ·

### 4.5 æƒé™æ§åˆ¶

#### 4.5.1 è·¯ç”±ä¿æŠ¤

åˆ›å»º `components/admin/AdminRouteGuard.tsx`ï¼š

```tsx
'use client';

import { useAuth } from '@/context/AuthContext';
import { useRouter } from 'next/navigation';
import { useEffect } from 'react';

export default function AdminRouteGuard({ children }: { children: React.ReactNode }) {
  const { user, isLoading } = useAuth();
  const router = useRouter();

  useEffect(() => {
    if (!isLoading) {
      if (!user) {
        router.push('/login');
      } else if (user.role !== 'ADMIN') {
        router.push('/editor');
      }
    }
  }, [user, isLoading, router]);

  if (isLoading) {
    return <div>åŠ è½½ä¸­...</div>;
  }

  if (!user || user.role !== 'ADMIN') {
    return null;
  }

  return <>{children}</>;
}
```

#### 4.5.2 API è·¯ç”±ä¿æŠ¤

åˆ›å»º `lib/admin-middleware.ts`ï¼š

```typescript
import { NextRequest, NextResponse } from 'next/server';
import { verify } from 'jsonwebtoken';
import prisma from '@/lib/prisma';

const JWT_SECRET = process.env.JWT_SECRET || 'your-super-secret-key';

export async function verifyAdmin(request: NextRequest) {
  const authHeader = request.headers.get('authorization');
  if (!authHeader?.startsWith('Bearer ')) {
    return NextResponse.json({ error: 'æœªç™»å½•' }, { status: 401 });
  }

  const token = authHeader.split(' ')[1];
  
  try {
    const decoded = verify(token, JWT_SECRET) as { userId: number; email: string };
    
    const user = await prisma.user.findUnique({
      where: { id: decoded.userId }
    });
    
    if (!user || user.role !== 'ADMIN') {
      return NextResponse.json({ error: 'æ— ç®¡ç†å‘˜æƒé™' }, { status: 403 });
    }
    
    return { success: true, user, decoded };
  } catch (error) {
    return NextResponse.json({ error: 'æ— æ•ˆ token' }, { status: 401 });
  }
}
```

### 4.6 ä¾§è¾¹æ å¯¼èˆªè®¾è®¡

æ ¹æ®è®¾è®¡æ–‡æ¡£è¦æ±‚ï¼Œç®¡ç†å‘˜ç™»å½•åï¼Œä¾§è¾¹æ åº”æ˜¾ç¤ºç®¡ç†åŠŸèƒ½çš„å…¥å£ï¼Œç”¨æˆ·ç‚¹å‡»åå¯ä»¥è·³è½¬åˆ°ç›¸åº”çš„é¡µé¢ã€‚

#### 4.6.1 ä¾§è¾¹æ å¯¼èˆªç»“æ„

**æ™®é€šç”¨æˆ·ä¾§è¾¹æ ï¼ˆæœªç™»å½•æˆ–æ™®é€šç”¨æˆ·ç™»å½•ï¼‰ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Logo          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ  é¦–é¡µ       â”‚
â”‚  ğŸ¨ å·¥ä½œå°     â”‚
â”‚  ğŸ“š å†å²è®°å½•   â”‚
â”‚  ğŸ‘¤ ä¸ªäººä¸­å¿ƒ   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç®¡ç†å‘˜ä¾§è¾¹æ ï¼ˆç®¡ç†å‘˜ç™»å½•åï¼‰ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Logo          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç”¨æˆ·åŠŸèƒ½        â”‚
â”‚  ğŸ  é¦–é¡µ       â”‚
â”‚  ğŸ¨ å·¥ä½œå°     â”‚
â”‚  ğŸ“š å†å²è®°å½•   â”‚
â”‚  ğŸ‘¤ ä¸ªäººä¸­å¿ƒ   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç®¡ç†åŠŸèƒ½        â”‚
â”‚  ğŸ›¡ï¸ ç®¡ç†åå°   â”‚
â”‚    â”œâ”€ ğŸ“Š ç»Ÿè®¡æ•°æ® â”‚
â”‚    â”œâ”€ ğŸ‘¥ ç”¨æˆ·ç®¡ç† â”‚
â”‚    â””â”€ ğŸ“„ è®°å½•ç®¡ç† â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.6.2 ä¾§è¾¹æ å®ç°æ–¹æ¡ˆ

ä¿®æ”¹ä¾§è¾¹æ ç»„ä»¶ `components/sidebar.tsx`ï¼Œæ·»åŠ ç®¡ç†å‘˜å¯¼èˆªå…¥å£ï¼š

```tsx
'use client';

import { useAuth } from '@/context/AuthContext';
import { Home, Palette, History, User, Shield, BarChart3, Users, FileText } from 'lucide-react';

export default function Sidebar() {
  const { user } = useAuth();
  const isAdmin = user?.role === 'ADMIN';

  return (
    <div className="w-64 bg-gray-900 text-white h-screen fixed left-0 top-0">
      {/* Logo */}
      <div className="p-4 border-b border-gray-700">
        <h1 className="text-xl font-bold">iRetexturing</h1>
      </div>

      {/* ç”¨æˆ·åŠŸèƒ½åŒºåŸŸ */}
      <div className="p-4">
        <div className="text-xs text-gray-400 mb-2">ç”¨æˆ·åŠŸèƒ½</div>
        <nav className="space-y-2">
          <SidebarItem href="/" icon={<Home size={20} />} label="é¦–é¡µ" />
          <SidebarItem href="/playground" icon={<Palette size={20} />} label="å·¥ä½œå°" />
          <SidebarItem href="/history" icon={<History size={20} />} label="å†å²è®°å½•" />
          <SidebarItem href="/profile" icon={<User size={20} />} label="ä¸ªäººä¸­å¿ƒ" />
        </nav>
      </div>

      {/* ç®¡ç†åŠŸèƒ½åŒºåŸŸ - ä»…ç®¡ç†å‘˜å¯è§ */}
      {isAdmin && (
        <div className="p-4 border-t border-gray-700">
          <div className="text-xs text-gray-400 mb-2">ç®¡ç†åŠŸèƒ½</div>
          <nav className="space-y-2">
            <SidebarItem
              href="/admin"
              icon={<Shield size={20} />}
              label="ç®¡ç†åå°"
              isActive={true}
            />
            <div className="ml-6 space-y-2">
              <SidebarItem
                href="/admin"
                icon={<BarChart3 size={16} />}
                label="ç»Ÿè®¡æ•°æ®"
              />
              <SidebarItem
                href="/admin/users"
                icon={<Users size={16} />}
                label="ç”¨æˆ·ç®¡ç†"
              />
              <SidebarItem
                href="/admin/histories"
                icon={<FileText size={16} />}
                label="è®°å½•ç®¡ç†"
              />
            </div>
          </nav>
        </div>
      )}
    </div>
  );
}

function SidebarItem({ href, icon, label, isActive = false }) {
  return (
    <a
      href={href}
      className={`flex items-center space-x-3 px-3 py-2 rounded-lg transition-colors ${
        isActive ? 'bg-blue-600 text-white' : 'text-gray-300 hover:bg-gray-800'
      }`}
    >
      {icon}
      <span>{label}</span>
    </a>
  );
}
```

#### 4.6.3 å¯¼èˆªäº¤äº’é€»è¾‘

**ç®¡ç†å‘˜ç™»å½•æµç¨‹ï¼š**
1. ç”¨æˆ·åœ¨ç™»å½•ç•Œé¢é€‰æ‹©"ç®¡ç†å‘˜ç™»å½•"
2. è¾“å…¥ç®¡ç†å‘˜è´¦å·å’Œå¯†ç 
3. ç™»å½•æˆåŠŸåï¼Œä¾§è¾¹æ è‡ªåŠ¨æ˜¾ç¤º"ç®¡ç†åŠŸèƒ½"åŒºåŸŸ
4. ç‚¹å‡»"ç®¡ç†åå°"è·³è½¬åˆ° `/admin` é¡µé¢ï¼ˆç»Ÿè®¡æ•°æ®ï¼‰
5. åœ¨ç®¡ç†åå°é¡µé¢ä¸­ï¼Œå¯ä»¥ç‚¹å‡»å­èœå•è·³è½¬åˆ°ç”¨æˆ·ç®¡ç†æˆ–è®°å½•ç®¡ç†é¡µé¢

**ç”¨æˆ·è§’è‰²åˆ‡æ¢ï¼š**
- å½“ç”¨æˆ·ç™»å½•çŠ¶æ€æ”¹å˜æ—¶ï¼Œä¾§è¾¹æ ä¼šè‡ªåŠ¨æ›´æ–°æ˜¾ç¤º
- æ™®é€šç”¨æˆ·ç™»å½•ï¼šåªæ˜¾ç¤ºç”¨æˆ·åŠŸèƒ½
- ç®¡ç†å‘˜ç™»å½•ï¼šæ˜¾ç¤ºç”¨æˆ·åŠŸèƒ½ + ç®¡ç†åŠŸèƒ½
- æœªç™»å½•ï¼šåªæ˜¾ç¤ºç”¨æˆ·åŠŸèƒ½ï¼ˆæˆ–éšè—éœ€è¦ç™»å½•çš„åŠŸèƒ½ï¼‰

**é¡µé¢è·¯ç”±ä¿æŠ¤ï¼š**
- æ‰€æœ‰ `/admin/*` è·¯ç”±éƒ½ä½¿ç”¨ `AdminRouteGuard` ä¿æŠ¤
- æ™®é€šç”¨æˆ·è®¿é—® `/admin/*` ä¼šè¢«é‡å®šå‘åˆ°é¦–é¡µæˆ–å·¥ä½œå°
- æœªç™»å½•ç”¨æˆ·è®¿é—® `/admin/*` ä¼šè¢«é‡å®šå‘åˆ°ç™»å½•é¡µé¢

#### 4.6.4 ä¾§è¾¹æ æ ·å¼è®¾è®¡

**è®¾è®¡åŸåˆ™ï¼š**
1. **è§†è§‰åŒºåˆ†**ï¼šç®¡ç†åŠŸèƒ½åŒºåŸŸä½¿ç”¨ä¸åŒçš„èƒŒæ™¯è‰²æˆ–åˆ†éš”çº¿ï¼Œä¸ç”¨æˆ·åŠŸèƒ½åŒºåŸŸæ˜æ˜¾åŒºåˆ†
2. **å›¾æ ‡ç»Ÿä¸€**ï¼šä½¿ç”¨ Lucide React å›¾æ ‡åº“ï¼Œä¿æŒå›¾æ ‡é£æ ¼ä¸€è‡´
3. **å±‚çº§æ¸…æ™°**ï¼šç®¡ç†åå°çš„å­èœå•ä½¿ç”¨ç¼©è¿›æ˜¾ç¤ºï¼Œä½“ç°å±‚çº§å…³ç³»
4. **çŠ¶æ€åé¦ˆ**ï¼šå½“å‰é¡µé¢é«˜äº®æ˜¾ç¤ºï¼Œæä¾›æ¸…æ™°çš„å¯¼èˆªåé¦ˆ
5. **å“åº”å¼è®¾è®¡**ï¼šåœ¨å°å±å¹•ä¸Šä¾§è¾¹æ å¯ä»¥æŠ˜å æˆ–è½¬æ¢ä¸ºæŠ½å±‰å¼èœå•

**æ ·å¼ç¤ºä¾‹ï¼š**
- ç”¨æˆ·åŠŸèƒ½åŒºåŸŸï¼šæ·±ç°è‰²èƒŒæ™¯
- ç®¡ç†åŠŸèƒ½åŒºåŸŸï¼šæ·±è“è‰²èƒŒæ™¯æˆ–å¸¦æœ‰è“è‰²è¾¹æ¡†
- å½“å‰é¡µé¢ï¼šè“è‰²é«˜äº®
- æ‚¬åœæ•ˆæœï¼šæµ…ç°è‰²èƒŒæ™¯

## 5. å®æ–½æ­¥éª¤

### é˜¶æ®µä¸€ï¼šæ•°æ®åº“å’Œè®¤è¯ç³»ç»Ÿï¼ˆ1-2å¤©ï¼‰

1. **æ•°æ®åº“è¿ç§»**
   - [ ] ä¿®æ”¹ `prisma/schema.prisma`ï¼Œæ·»åŠ  `role` å’Œ `updatedAt` å­—æ®µ
   - [ ] è¿è¡Œ `npx prisma migrate dev --name add_admin_role`
   - [ ] åˆ›å»ºåˆå§‹ç®¡ç†å‘˜è´¦æˆ·ï¼ˆé€šè¿‡æ•°æ®åº“è„šæœ¬ï¼‰
   - [ ] éªŒè¯æ•°æ®åº“è¿ç§»æˆåŠŸï¼Œæ•°æ®å®Œæ•´æ€§æ£€æŸ¥

2. **è®¤è¯ç³»ç»Ÿæ‰©å±•**
   - [ ] ä¿®æ”¹ `context/AuthContext.tsx`ï¼Œæ·»åŠ è§’è‰²å­—æ®µå’Œ `isAdmin` å±æ€§
   - [ ] æ›´æ–° `app/api/auth/login/route.ts`ï¼Œè¿”å›è§’è‰²ä¿¡æ¯
   - [ ] åˆ›å»º `lib/admin-auth.ts`ï¼Œæä¾›ç®¡ç†å‘˜éªŒè¯å‡½æ•°
   - [ ] æ›´æ–° TypeScript ç±»å‹å®šä¹‰

3. **æµ‹è¯•è®¤è¯**
   - [ ] æµ‹è¯•ç®¡ç†å‘˜ç™»å½•åŠŸèƒ½
   - [ ] æµ‹è¯•æ™®é€šç”¨æˆ·ç™»å½•åŠŸèƒ½
   - [ ] æµ‹è¯•è§’è‰²æƒé™éªŒè¯
   - [ ] æµ‹è¯• token éªŒè¯å’Œè¿‡æœŸå¤„ç†

### é˜¶æ®µäºŒï¼šåç«¯ API å¼€å‘ï¼ˆ2-3å¤©ï¼‰

1. **ç”¨æˆ·ç®¡ç† API**
   - [ ] åˆ›å»º `app/api/admin/users/route.ts`ï¼ˆGET, POSTï¼‰
     - [ ] å®ç°è·å–ç”¨æˆ·åˆ—è¡¨åŠŸèƒ½ï¼ˆæ”¯æŒåˆ†é¡µã€æœç´¢ã€ç­›é€‰ï¼‰
     - [ ] å®ç°åˆ›å»ºæ–°ç”¨æˆ·åŠŸèƒ½
     - [ ] æ·»åŠ æƒé™éªŒè¯
     - [ ] æ·»åŠ æ•°æ®éªŒè¯
   - [ ] åˆ›å»º `app/api/admin/users/[id]/route.ts`ï¼ˆGET, PUT, DELETEï¼‰
     - [ ] å®ç°è·å–ç”¨æˆ·è¯¦æƒ…åŠŸèƒ½
     - [ ] å®ç°æ›´æ–°ç”¨æˆ·ä¿¡æ¯åŠŸèƒ½
     - [ ] å®ç°åˆ é™¤ç”¨æˆ·åŠŸèƒ½ï¼ˆçº§è”åˆ é™¤å†å²è®°å½•ï¼‰
     - [ ] æ·»åŠ æƒé™éªŒè¯
   - [ ] åˆ›å»º `app/api/admin/users/[id]/reset-password/route.ts`ï¼ˆPOSTï¼‰
     - [ ] å®ç°é‡ç½®ç”¨æˆ·å¯†ç åŠŸèƒ½
     - [ ] æ·»åŠ å¯†ç å¼ºåº¦éªŒè¯
     - [ ] æ·»åŠ æƒé™éªŒè¯

2. **ç”Ÿæˆè®°å½•ç®¡ç† API**
   - [ ] åˆ›å»º `app/api/admin/histories/route.ts`ï¼ˆGETï¼‰
     - [ ] å®ç°è·å–æ‰€æœ‰è®°å½•åŠŸèƒ½ï¼ˆæ”¯æŒåˆ†é¡µã€ç­›é€‰ï¼‰
     - [ ] æ·»åŠ æƒé™éªŒè¯
   - [ ] åˆ›å»º `app/api/admin/histories/[id]/route.ts`ï¼ˆDELETEï¼‰
     - [ ] å®ç°åˆ é™¤æŒ‡å®šè®°å½•åŠŸèƒ½
     - [ ] æ·»åŠ æƒé™éªŒè¯
   - [ ] åˆ›å»º `app/api/admin/histories/batch/route.ts`ï¼ˆDELETEï¼‰
     - [ ] å®ç°æ‰¹é‡åˆ é™¤è®°å½•åŠŸèƒ½
     - [ ] æ·»åŠ æƒé™éªŒè¯
   - [ ] åˆ›å»º `app/api/admin/histories/user/[userId]/route.ts`ï¼ˆDELETEï¼‰
     - [ ] å®ç°åˆ é™¤æŒ‡å®šç”¨æˆ·çš„æ‰€æœ‰è®°å½•åŠŸèƒ½
     - [ ] æ·»åŠ æƒé™éªŒè¯

3. **ç»Ÿè®¡æ•°æ® API**
   - [ ] åˆ›å»º `app/api/admin/stats/route.ts`ï¼ˆGETï¼‰
     - [ ] å®ç°è·å–ç”¨æˆ·æ€»æ•°åŠŸèƒ½
     - [ ] å®ç°è·å–ç®¡ç†å‘˜æ•°é‡åŠŸèƒ½
     - [ ] å®ç°è·å–å†å²è®°å½•æ€»æ•°åŠŸèƒ½
     - [ ] å®ç°è·å–ä»Šæ—¥æ–°å¢ç”¨æˆ·æ•°åŠŸèƒ½
     - [ ] å®ç°è·å–ä»Šæ—¥ç”Ÿæˆè®°å½•æ•°åŠŸèƒ½
     - [ ] å®ç°è·å–å­˜å‚¨ä½¿ç”¨æƒ…å†µåŠŸèƒ½
     - [ ] æ·»åŠ æƒé™éªŒè¯

4. **API æµ‹è¯•**
   - [ ] ä½¿ç”¨ Postman æˆ–ç±»ä¼¼å·¥å…·æµ‹è¯•æ‰€æœ‰ API
   - [ ] æµ‹è¯•æƒé™éªŒè¯ï¼ˆæœªç™»å½•ã€æ™®é€šç”¨æˆ·ã€ç®¡ç†å‘˜ï¼‰
   - [ ] æµ‹è¯•é”™è¯¯å¤„ç†
   - [ ] æµ‹è¯•è¾¹ç•Œæƒ…å†µ
   - [ ] æµ‹è¯•æ•°æ®éªŒè¯

### é˜¶æ®µä¸‰ï¼šå‰ç«¯ç•Œé¢å¼€å‘ï¼ˆ3-4å¤©ï¼‰

1. **ç™»å½•ç•Œé¢æ”¹é€ **
   - [ ] ä¿®æ”¹ `app/login/[[...login]]/page.tsx`ï¼Œæ·»åŠ ç®¡ç†å‘˜ç™»å½•é€‰é¡¹
   - [ ] æ·»åŠ ç®¡ç†å‘˜ç™»å½•æ ·å¼
   - [ ] å®ç°ç”¨æˆ·/ç®¡ç†å‘˜ç™»å½•æ¨¡å¼åˆ‡æ¢
   - [ ] æµ‹è¯•ç™»å½•åŠŸèƒ½

2. **æƒé™ä¿æŠ¤ç»„ä»¶**
   - [ ] åˆ›å»º `components/admin/AdminRouteGuard.tsx`
     - [ ] å®ç°è·¯ç”±ä¿æŠ¤é€»è¾‘
     - [ ] æ·»åŠ åŠ è½½çŠ¶æ€
     - [ ] æ·»åŠ é”™è¯¯å¤„ç†
   - [ ] åˆ›å»º `lib/admin-middleware.ts`
     - [ ] å®ç° API æƒé™éªŒè¯
     - [ ] æ·»åŠ é”™è¯¯å“åº”

3. **ç®¡ç†å‘˜ä»ªè¡¨æ¿ï¼ˆç»Ÿè®¡æ•°æ®é¡µé¢ï¼‰**
   - [ ] åˆ›å»º `app/admin/page.tsx`
     - [ ] å®ç°ç»Ÿè®¡å¡ç‰‡ç»„ä»¶
     - [ ] å®ç°å¿«é€Ÿæ“ä½œåŒºåŸŸ
     - [ ] å®ç°å¯¼èˆªèœå•åŒºåŸŸ
     - [ ] æ·»åŠ åŠ è½½çŠ¶æ€
     - [ ] æ·»åŠ é”™è¯¯å¤„ç†
   - [ ] é›†æˆç»Ÿè®¡æ•°æ® API
   - [ ] æµ‹è¯•æ•°æ®å±•ç¤º

4. **ç”¨æˆ·ç®¡ç†ç•Œé¢**
   - [ ] åˆ›å»º `app/admin/users/page.tsx`
     - [ ] å®ç°ç”¨æˆ·åˆ—è¡¨è¡¨æ ¼
     - [ ] å®ç°æœç´¢å’Œç­›é€‰åŠŸèƒ½
     - [ ] å®ç°åˆ†é¡µæ§åˆ¶
     - [ ] å®ç°ç”¨æˆ·è¯¦æƒ…å¼¹çª—
     - [ ] å®ç°ç¼–è¾‘ç”¨æˆ·å¼¹çª—
     - [ ] å®ç°åˆ›å»ºç”¨æˆ·å¼¹çª—
     - [ ] å®ç°é‡ç½®å¯†ç å¼¹çª—
     - [ ] å®ç°åˆ é™¤ç¡®è®¤å¯¹è¯æ¡†
     - [ ] æ·»åŠ åŠ è½½çŠ¶æ€
     - [ ] æ·»åŠ é”™è¯¯å¤„ç†
   - [ ] é›†æˆç”¨æˆ·ç®¡ç† API
   - [ ] æµ‹è¯•æ‰€æœ‰ç”¨æˆ·ç®¡ç†åŠŸèƒ½

5. **ç”Ÿæˆè®°å½•ç®¡ç†ç•Œé¢**
   - [ ] åˆ›å»º `app/admin/histories/page.tsx`
     - [ ] å®ç°è®°å½•åˆ—è¡¨è¡¨æ ¼
     - [ ] å®ç°ç­›é€‰åŠŸèƒ½
     - [ ] å®ç°æ‰¹é‡æ“ä½œåŠŸèƒ½
     - [ ] å®ç°è®°å½•è¯¦æƒ…å¼¹çª—
     - [ ] å®ç°å›¾ç‰‡é¢„è§ˆç»„ä»¶
     - [ ] å®ç°æ‰¹é‡åˆ é™¤ç¡®è®¤å¯¹è¯æ¡†
     - [ ] å®ç°æ‰¹é‡å¯¼å‡ºåŠŸèƒ½
     - [ ] æ·»åŠ åŠ è½½çŠ¶æ€
     - [ ] æ·»åŠ é”™è¯¯å¤„ç†
   - [ ] é›†æˆç”Ÿæˆè®°å½•ç®¡ç† API
   - [ ] æµ‹è¯•æ‰€æœ‰è®°å½•ç®¡ç†åŠŸèƒ½

6. **ç”¨æˆ·è¯¦æƒ…é¡µé¢**
   - [ ] åˆ›å»º `app/admin/users/[id]/page.tsx`
     - [ ] æ˜¾ç¤ºç”¨æˆ·åŸºæœ¬ä¿¡æ¯
     - [ ] æ˜¾ç¤ºå†å²è®°å½•ç»Ÿè®¡
     - [ ] æ˜¾ç¤ºå†å²è®°å½•åˆ—è¡¨
     - [ ] æ·»åŠ æ“ä½œæŒ‰é’®
     - [ ] æ·»åŠ åŠ è½½çŠ¶æ€
     - [ ] æ·»åŠ é”™è¯¯å¤„ç†
   - [ ] é›†æˆç”¨æˆ·è¯¦æƒ… API
   - [ ] æµ‹è¯•é¡µé¢åŠŸèƒ½

7. **ä¾§è¾¹æ å¯¼èˆªæ‰©å±•**
   - [ ] ä¿®æ”¹ `components/sidebar.tsx`ï¼Œæ·»åŠ ç®¡ç†å…¥å£
     - [ ] å®ç°ç”¨æˆ·åŠŸèƒ½åŒºåŸŸ
     - [ ] å®ç°ç®¡ç†åŠŸèƒ½åŒºåŸŸï¼ˆä»…ç®¡ç†å‘˜å¯è§ï¼‰
     - [ ] å®ç°å­èœå•æ˜¾ç¤º
     - [ ] å®ç°å½“å‰é¡µé¢é«˜äº®
     - [ ] æ·»åŠ æ‚¬åœæ•ˆæœ
   - [ ] æµ‹è¯•å¯¼èˆªåŠŸèƒ½
   - [ ] æµ‹è¯•æƒé™æ§åˆ¶

8. **ç•Œé¢æ ·å¼ä¼˜åŒ–**
   - [ ] ç¡®ä¿ç®¡ç†å‘˜ç•Œé¢ä¸ç”¨æˆ·ç•Œé¢æœ‰æ˜æ˜¾è§†è§‰åŒºåˆ†
   - [ ] ä¼˜åŒ–å“åº”å¼è®¾è®¡
   - [ ] æ·»åŠ è¿‡æ¸¡åŠ¨ç”»
   - [ ] ç»Ÿä¸€è®¾è®¡é£æ ¼

### é˜¶æ®µå››ï¼šæµ‹è¯•å’Œä¼˜åŒ–ï¼ˆ1-2å¤©ï¼‰

1. **åŠŸèƒ½æµ‹è¯•**
   - [ ] æµ‹è¯•æ‰€æœ‰ç®¡ç†å‘˜åŠŸèƒ½
   - [ ] æµ‹è¯•æƒé™æ§åˆ¶
   - [ ] æµ‹è¯•è¾¹ç•Œæƒ…å†µ
   - [ ] æµ‹è¯•æ•°æ®ä¸€è‡´æ€§
   - [ ] æµ‹è¯•å¹¶å‘æ“ä½œ

2. **UI/UX ä¼˜åŒ–**
   - [ ] ä¼˜åŒ–å“åº”å¼è®¾è®¡
   - [ ] æ·»åŠ åŠ è½½çŠ¶æ€
   - [ ] æ·»åŠ é”™è¯¯æç¤º
   - [ ] æ·»åŠ ç¡®è®¤å¯¹è¯æ¡†
   - [ ] ä¼˜åŒ–è¡¨å•éªŒè¯æç¤º
   - [ ] ä¼˜åŒ–ç§»åŠ¨ç«¯ä½“éªŒ

3. **æ€§èƒ½ä¼˜åŒ–**
   - [ ] ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢
   - [ ] æ·»åŠ åˆ†é¡µ
   - [ ] æ·»åŠ ç¼“å­˜
   - [ ] ä¼˜åŒ–å›¾ç‰‡åŠ è½½
   - [ ] å‡å°‘ä¸å¿…è¦çš„é‡æ¸²æŸ“

4. **å®‰å…¨æ£€æŸ¥**
   - [ ] æ£€æŸ¥ SQL æ³¨å…¥é£é™©
   - [ ] æ£€æŸ¥ XSS é£é™©
   - [ ] æ£€æŸ¥ CSRF é£é™©
   - [ ] æ£€æŸ¥æ•æ„Ÿä¿¡æ¯æ³„éœ²
   - [ ] æ£€æŸ¥æƒé™æå‡æ¼æ´
   - [ ] æ£€æŸ¥è¾“å…¥éªŒè¯

5. **æ–‡æ¡£æ›´æ–°**
   - [ ] æ›´æ–° API æ–‡æ¡£
   - [ ] æ›´æ–°ç”¨æˆ·æ‰‹å†Œ
   - [ ] æ›´æ–°éƒ¨ç½²æ–‡æ¡£
   - [ ] æ·»åŠ ç®¡ç†å‘˜ä½¿ç”¨æŒ‡å—

### é˜¶æ®µäº”ï¼šéƒ¨ç½²å’Œä¸Šçº¿ï¼ˆ1å¤©ï¼‰

1. **éƒ¨ç½²å‡†å¤‡**
   - [ ] é…ç½®ç”Ÿäº§ç¯å¢ƒå˜é‡
   - [ ] è®¾ç½®æ•°æ®åº“å¤‡ä»½
   - [ ] é…ç½®æ—¥å¿—è®°å½•
   - [ ] è®¾ç½®ç›‘æ§å‘Šè­¦

2. **éƒ¨ç½²å®æ–½**
   - [ ] æ‰§è¡Œæ•°æ®åº“è¿ç§»
   - [ ] éƒ¨ç½²åº”ç”¨ä»£ç 
   - [ ] åˆ›å»ºåˆå§‹ç®¡ç†å‘˜è´¦æˆ·
   - [ ] éªŒè¯éƒ¨ç½²æˆåŠŸ

3. **ä¸Šçº¿éªŒè¯**
   - [ ] æµ‹è¯•æ‰€æœ‰åŠŸèƒ½
   - [ ] æµ‹è¯•æƒé™æ§åˆ¶
   - [ ] æµ‹è¯•æ€§èƒ½
   - [ ] ç›‘æ§ç³»ç»Ÿè¿è¡ŒçŠ¶æ€

## 6. æŠ€æœ¯ç»†èŠ‚

### 6.1 æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬

åˆ›å»º `scripts/create-admin.ts`ï¼Œç”¨äºåˆ›å»ºåˆå§‹ç®¡ç†å‘˜è´¦æˆ·ï¼š

```typescript
import { PrismaClient } from '@prisma/client';
import bcrypt from 'bcrypt';

const prisma = new PrismaClient();

async function createAdmin() {
  const email = 'admin@iretexturing.com';
  const password = 'admin123456';
  const name = 'ç³»ç»Ÿç®¡ç†å‘˜';

  const hashedPassword = await bcrypt.hash(password, 10);

  const admin = await prisma.user.create({
    data: {
      email,
      password: hashedPassword,
      name,
      role: 'ADMIN',
    },
  });

  console.log('ç®¡ç†å‘˜è´¦æˆ·åˆ›å»ºæˆåŠŸ:', admin);
}

createAdmin()
  .catch(console.error)
  .finally(() => prisma.$disconnect());
```

### 6.2 ç¯å¢ƒå˜é‡

åœ¨ `.env.local` ä¸­æ·»åŠ ï¼š

```env
# JWT å¯†é’¥ï¼ˆç”Ÿäº§ç¯å¢ƒå¿…é¡»æ›´æ”¹ï¼‰
JWT_SECRET=your-super-secret-key-change-in-production

# ç®¡ç†å‘˜é‚®ç®±ï¼ˆå¯é€‰ï¼Œç”¨äºéªŒè¯ï¼‰
ADMIN_EMAIL=admin@iretexturing.com
```

### 6.3 é”™è¯¯å¤„ç†

ç»Ÿä¸€é”™è¯¯å“åº”æ ¼å¼ï¼š

```typescript
{
  error: string;      // é”™è¯¯ä¿¡æ¯
  code?: string;      // é”™è¯¯ä»£ç 
  details?: any;      // è¯¦ç»†ä¿¡æ¯
}
```

å¸¸è§é”™è¯¯ä»£ç ï¼š
- `UNAUTHORIZED`: æœªç™»å½•
- `FORBIDDEN`: æ— æƒé™
- `NOT_FOUND`: èµ„æºä¸å­˜åœ¨
- `VALIDATION_ERROR`: å‚æ•°éªŒè¯å¤±è´¥
- `INTERNAL_ERROR`: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯

### 6.4 æ—¥å¿—è®°å½•

åˆ›å»º `lib/logger.ts`ï¼Œè®°å½•ç®¡ç†å‘˜æ“ä½œï¼š

```typescript
export async function logAdminAction(
  adminId: number,
  action: string,
  target: string,
  details?: any
) {
  // è®°å½•åˆ°æ•°æ®åº“æˆ–æ–‡ä»¶
  console.log(`[ADMIN] User ${adminId} performed ${action} on ${target}`, details);
}
```

## 7. å®‰å…¨è€ƒè™‘

### 7.1 æƒé™éªŒè¯

- æ‰€æœ‰ç®¡ç†å‘˜ API å¿…é¡»éªŒè¯ç®¡ç†å‘˜æƒé™
- å‰ç«¯è·¯ç”±å¿…é¡»ä½¿ç”¨ AdminRouteGuard ä¿æŠ¤
- æ•æ„Ÿæ“ä½œï¼ˆåˆ é™¤ã€é‡ç½®å¯†ç ï¼‰éœ€è¦äºŒæ¬¡ç¡®è®¤

### 7.2 æ•°æ®éªŒè¯

- æ‰€æœ‰è¾“å…¥æ•°æ®å¿…é¡»éªŒè¯
- é‚®ç®±æ ¼å¼éªŒè¯
- å¯†ç å¼ºåº¦éªŒè¯ï¼ˆè‡³å°‘ 8 ä½ï¼ŒåŒ…å«å­—æ¯å’Œæ•°å­—ï¼‰
- è§’è‰²æšä¸¾éªŒè¯

### 7.3 å®¡è®¡æ—¥å¿—

- è®°å½•æ‰€æœ‰ç®¡ç†å‘˜æ“ä½œ
- è®°å½•æ“ä½œæ—¶é—´ã€æ“ä½œäººã€æ“ä½œå†…å®¹
- ä¾¿äºè¿½æº¯å’Œå®¡è®¡

### 7.4 å¯†ç å®‰å…¨

- ç®¡ç†å‘˜å¯†ç å¿…é¡»ç¬¦åˆå®‰å…¨è¦æ±‚
- é‡ç½®å¯†ç æ—¶ç”Ÿæˆä¸´æ—¶å¯†ç 
- å»ºè®®ç®¡ç†å‘˜å®šæœŸæ›´æ¢å¯†ç 

## 8. æœªæ¥æ‰©å±•

### 8.1 åŠŸèƒ½æ‰©å±•

1. **ç³»ç»Ÿè®¾ç½®**
   - ç³»ç»Ÿé…ç½®ç®¡ç†
   - é‚®ä»¶é€šçŸ¥è®¾ç½®
   - å­˜å‚¨é…é¢ç®¡ç†

2. **æ—¥å¿—ç®¡ç†**
   - æ“ä½œæ—¥å¿—æŸ¥çœ‹
   - é”™è¯¯æ—¥å¿—æŸ¥çœ‹
   - æ—¥å¿—å¯¼å‡ºåŠŸèƒ½

3. **æ•°æ®åˆ†æ**
   - ç”¨æˆ·è¡Œä¸ºåˆ†æ
   - ç”Ÿæˆè®°å½•ç»Ÿè®¡
   - å­˜å‚¨ä½¿ç”¨è¶‹åŠ¿

4. **å¤‡ä»½å’Œæ¢å¤**
   - æ•°æ®åº“å¤‡ä»½
   - æ•°æ®æ¢å¤
   - è‡ªåŠ¨å¤‡ä»½é…ç½®

### 8.2 æ€§èƒ½ä¼˜åŒ–

1. **ç¼“å­˜ç­–ç•¥**
   - Redis ç¼“å­˜ç»Ÿè®¡æ•°æ®
   - ç¼“å­˜ç”¨æˆ·åˆ—è¡¨
   - ç¼“å­˜å†å²è®°å½•

2. **æ•°æ®åº“ä¼˜åŒ–**
   - æ·»åŠ ç´¢å¼•
   - ä¼˜åŒ–æŸ¥è¯¢
   - æ•°æ®åº“åˆ†è¡¨

3. **CDN åŠ é€Ÿ**
   - å›¾ç‰‡ CDN
   - é™æ€èµ„æº CDN

## 9. é£é™©å’ŒæŒ‘æˆ˜

### 9.1 æŠ€æœ¯é£é™©

1. **æ•°æ®åº“è¿ç§»é£é™©**
   - ç°æœ‰æ•°æ®å…¼å®¹æ€§
   - è¿ç§»å¤±è´¥å›æ»šæ–¹æ¡ˆ

2. **æƒé™æ§åˆ¶é£é™©**
   - æƒé™éªŒè¯é—æ¼
   - æƒé™æå‡æ¼æ´

3. **æ€§èƒ½é£é™©**
   - å¤§é‡æ•°æ®æŸ¥è¯¢æ€§èƒ½
   - å¹¶å‘æ“ä½œæ€§èƒ½

### 9.2 ç¼“è§£æªæ–½

1. **æµ‹è¯•å……åˆ†**
   - å•å…ƒæµ‹è¯•
   - é›†æˆæµ‹è¯•
   - å‹åŠ›æµ‹è¯•

2. **ä»£ç å®¡æŸ¥**
   - ä»£ç è§„èŒƒæ£€æŸ¥
   - å®‰å…¨å®¡æŸ¥
   - æ€§èƒ½å®¡æŸ¥

3. **ç›‘æ§å’Œå‘Šè­¦**
   - ç³»ç»Ÿç›‘æ§
   - é”™è¯¯å‘Šè­¦
   - æ€§èƒ½ç›‘æ§

## 10. æ€»ç»“

æœ¬å®ç°è®¡åˆ’è¯¦ç»†è§„åˆ’äº† iRetexturing ç³»ç»Ÿç®¡ç†å‘˜åŠŸèƒ½çš„å®Œæ•´å®ç°æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ï¼š

1. æ•°æ®åº“æ¨¡å‹æ‰©å±•
2. è®¤è¯ç³»ç»Ÿæ”¹é€ 
3. åç«¯ API å¼€å‘
4. å‰ç«¯ç•Œé¢å¼€å‘
5. æƒé™æ§åˆ¶æœºåˆ¶
6. å®‰å…¨è€ƒè™‘

é¢„è®¡æ€»å¼€å‘æ—¶é—´ï¼š7-11 å¤©

å…³é”®æˆåŠŸå› ç´ ï¼š
- ä¸¥æ ¼çš„æƒé™æ§åˆ¶
- å®Œå–„çš„é”™è¯¯å¤„ç†
- è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒ
- å……åˆ†çš„æµ‹è¯•è¦†ç›–
- è¯¦ç»†çš„å®‰å…¨è€ƒè™‘

é€šè¿‡æœ¬è®¡åˆ’çš„å®æ–½ï¼Œç³»ç»Ÿå°†å…·å¤‡å®Œæ•´çš„ç®¡ç†å‘˜åŠŸèƒ½ï¼Œèƒ½å¤Ÿæœ‰æ•ˆç®¡ç†ç”¨æˆ·å’Œç”Ÿæˆè®°å½•ï¼Œä¸ºç³»ç»Ÿè¿ç»´æä¾›å¼ºæœ‰åŠ›çš„æ”¯æŒã€‚
